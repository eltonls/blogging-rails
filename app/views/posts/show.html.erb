<section class="container my-5">
  <header class="d-flex justify-content-between align-items-baseline">
    <h2 class="text-wrap text-uppercase fw-bold w-75">
      <%= @post.title %>
    </h2>
    <% if @post.user == current_user  %>
      <div class="d-flex justify-content-between">
        <%= button_to "Deletar", @post, method: :delete, data: { turbo_confirm: "Tem certeza?" }, class: "btn btn-outline-danger me-2" %>
        <%= link_to "Editar Post", edit_post_path , class: "btn btn-info" %>
      </div>
    <% end %>
  </header>
  <p>
    <% if @post.user == current_user  %>
      <p class="w-auto text-nowrap" if post.user == current_user>
        <span class="fw-bold">Autor:</span> Você
      </p>
    <% end %>
    <% if @post.user != current_user  %>
      <p class="w-auto text-nowrap" if post.user != current_user>
      <span class="fw-bold">Autor:</span> <%= @post.user.first_name + " " + @post.user.last_name %></p>
    <% end %>
  </p>
  <div class="d-flex flex-row mb-2">
    <% @post.tags.each do |tag| %>
        <span class="badge text-bg-info w-auto me-1">
          <%= tag.name %>
        </span>
    <% end %>
  </div>
  <div class="row post-content">
    <%= simple_format(@post.content) %>
  </div>
  <div> 
    <h3>Comentários</h3>
    <div id="comments">
      <% @comments.each do |comment| %>
        <div class="rounded-2 my-2 p-2">
          <p>
            <% if comment.user == nil  %>
              <strong>Anonimo</strong> 
            <% else  %>
              <strong class="border-b-2"><%= comment.user.first_name %> <%= comment.user.last_name %></strong> 
            <% end %>
          </p>          
          <span class=""><%= comment.created_at.to_formatted_s(:short)  %></span>
          <p><%= comment.content %></p>
        </div>
      <% end %>
      <%= paginate @comments, theme: "bootstrap-5" %>
    </div>

    <%= form_with model: [@post, Comment.new], local: true do |form| %>
      <div class="form-group mb-3">
        <%= form.label :content, "Criar novo Comentário", class: "fw-bold" %>
        <%= form.text_area :content, rows: 3, class: "form-control" %>
      </div>
      <div class="form-group">
        <%= form.submit "Post Comment", class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</section>

